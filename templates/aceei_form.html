<!DOCTYPE html>
<html lang="en">
<header>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="{{ url_for('static', filename='aceei.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='header.css') }}">
    <div class="backgroundHeader">
        <h1>ACEEI Algorithm</h1>
    </div>
</header>
<body>
<div class="aceeiFormContainer">
    <h2>Insert the parameters and run the algorithm &#128512;</h2>
    <form action="/process" method="POST" id="aceeiForm">
        <!-- Choose Number of Courses -->
        <div class="fieldsContainer">
            <label for="numberOfCourses">Number of Courses:</label>
            <input type="number" id="numberOfCourses" name="numberOfCourses" min="1" required>
            <button type="button" onclick="addCourseFields()">&#10004;</button><br><br>
        </div>
        <!-- Courses Input Fields (Generated Dynamically) -->
        <div id="courseFields">
            <!-- Fields for courses will be added dynamically -->
        </div>

        <div class="fieldsContainer">
            <!-- Choose Number of Students -->
            <label for="numberOfStudents">Number of Students:</label>
            <input type="number" id="numberOfStudents" name="numberOfStudents" min="1" required disabled>
            <button type="button" onclick="addStudentFields()">&#10004;</button><br><br>
        </div>
        <!-- Student Input Fields (Generated Dynamically) -->
        <div id="studentFields">
            <!-- Fields for students will be added dynamically -->
        </div>

        <div class="fieldsContainer">
            <!-- Epsilon (ε) Input Field -->
            <label for="epsilon">Epsilon (ε):</label>
            <input type="number" id="epsilon" name="epsilon" step="0.01" required><br><br>
        </div>

        <div class="fieldsContainer">
            <!-- Delta (δ) Input Field -->
            <label for="delta">Delta (δ):</label>
            <input type="number" id="delta" name="delta" step="0.01" required><br><br>
        </div>

        <div class="fieldsContainer">
            <!-- t Input Field with Options -->
            <label for="ef-tb">EF-TB status:</label>
            <select id="ef-tb" name="ef-tb" required>
                <option value="no EFTB">No EFTB</option>
                <option value="EFTB">EFTB</option>
                <option value="contested EFTB">Contested EFTB</option>
            </select><br><br>
        </div>

        <input type="submit" value="Run The Algorithm">
    </form>
</div>
<script>
    // Function to add course input fields dynamically
    function addCourseFields() {
        var numberOfCourses = parseInt(document.getElementById('numberOfCourses').value);
        var courseFieldsDiv = document.getElementById('courseFields');
        courseFieldsDiv.innerHTML = ''; // Clear previous fields

        for (var i = 1; i <= numberOfCourses; i++) {
            var courseField = document.createElement('div');
            courseField.className = 'courseField';

            var courseLabel = document.createElement('label');
            courseLabel.textContent = 'Course ' + i + ' Capacity: ';
            courseField.appendChild(courseLabel);

            var capacityInput = document.createElement('input');
            capacityInput.type = 'number';
            capacityInput.min = 1;
            capacityInput.name = 'c' + i + 'Capacity';
            capacityInput.required = true;
            capacityInput.addEventListener('input', checkAllCapacitiesFilled);
            courseField.appendChild(capacityInput);

            courseFieldsDiv.appendChild(courseField);
        }

        // Enable the number of students input field
        document.getElementById('numberOfStudents').disabled = true;
    }

    // Function to add student input fields dynamically
    function addStudentFields() {
        var numberOfStudents = parseInt(document.getElementById('numberOfStudents').value);
        var studentFieldsDiv = document.getElementById('studentFields');
        studentFieldsDiv.innerHTML = ''; // Clear previous fields

        var numberOfCourses = parseInt(document.getElementById('numberOfCourses').value);

        for (var i = 1; i <= numberOfStudents; i++) {
            var studentField = document.createElement('div');
            studentField.className = 'studentField';

            var studentLabel = document.createElement('div');
            studentLabel.className = 'studentLabel';
            studentLabel.textContent = 'Student ' + i;
            studentField.appendChild(studentLabel);

            var budgetGroup = document.createElement('div');
            budgetGroup.className = 'fieldGroup';
            var budgetLabel = document.createElement('label');
            budgetLabel.className = 'inputLabel';
            budgetLabel.textContent = 'Budget: ';
            budgetGroup.appendChild(budgetLabel);
            var budgetInput = document.createElement('input');
            budgetInput.type = 'number';
            budgetInput.name = 's' + i + 'Budget';
            budgetInput.min = 1;
            budgetInput.required = true;
            budgetGroup.appendChild(budgetInput);
            studentField.appendChild(budgetGroup);

            var coursesGroup = document.createElement('div');
            coursesGroup.className = 'fieldGroup';
            var coursesLabel = document.createElement('label');
            budgetLabel.className = 'inputLabel';
            coursesLabel.textContent = 'Courses to Take: ';
            coursesGroup.appendChild(coursesLabel);
            var coursesInput = document.createElement('input');
            coursesInput.type = 'number';
            coursesInput.min = 1;
            coursesInput.name = 's' + i + 'CoursesToTake';
            coursesInput.required = true;
            coursesGroup.appendChild(coursesInput);
            studentField.appendChild(coursesGroup);

            var ratingsLabel = document.createElement('label');
            ratingsLabel.className = 'inputLabel';
            ratingsLabel.textContent = 'Ratings for Courses: ';
            studentField.appendChild(ratingsLabel);

            var ratingsGroup = document.createElement('div');
            ratingsGroup.className = 'ratingsGroup';
            for (var j = 1; j <= numberOfCourses; j++) {
                var ratingRow = document.createElement('div');
                ratingRow.className = 'ratingRow';
                var ratingLabel = document.createElement('label');
                ratingsLabel.className = 'inputLabel';
                ratingLabel.textContent = 'c' + j + ': ';
                ratingRow.appendChild(ratingLabel);
                var ratingInput = document.createElement('input');
                ratingInput.type = 'number';
                ratingInput.name = 's' + i + 'c' + j + 'Rating';
                ratingInput.min = 1;
                ratingInput.step = 1;
                ratingInput.required = true;
                ratingRow.appendChild(ratingInput);
                ratingsGroup.appendChild(ratingRow);
            }
            studentField.appendChild(ratingsGroup);

            studentFieldsDiv.appendChild(studentField);

        }
    }

    // Function to check if all capacity fields are filled
    function checkAllCapacitiesFilled() {
        var numberOfCourses = parseInt(document.getElementById('numberOfCourses').value);
        var allFilled = true;

        for (var i = 1; i <= numberOfCourses; i++) {
            var capacityInput = document.querySelector('input[name="c' + i + 'Capacity"]');
            if (!capacityInput || capacityInput.value === '') {
                allFilled = false;
                break;
            }
        }

        document.getElementById('numberOfStudents').disabled = !allFilled;
    }

    // Enable the number of students input field when number of courses is selected
    document.getElementById('numberOfCourses').addEventListener('input', function() {
        var numberOfCourses = parseInt(document.getElementById('numberOfCourses').value);
        if (numberOfCourses > 0) {
            document.getElementById('numberOfStudents').disabled = true;
        } else {
            document.getElementById('numberOfStudents').disabled = true;
        }
    });
</script>
</body>
</html>
